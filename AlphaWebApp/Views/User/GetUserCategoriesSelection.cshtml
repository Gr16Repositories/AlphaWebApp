@model AlphaWebApp.Models.ViewModels.UserCategoriesSelectionVM

<style>
    #catsInNewsletter {
        border: 5px double dodgerblue;
        border-radius: 25px;
        padding: 5px;
    }
    #newsletterDiv1 {
        border-right: 5px double dodgerblue;
    }
    #newsletterDiv2 {
        border-left: 5px double dodgerblue;
    }
</style>

<div class="row">
    <div class="col-md-6" id="newsletterDiv1">
        <h1>Personalize Newsletter</h1><br />
        <form method="post" id="newsletterForm" asp-action="GetUserCategoriesSelection">

            @for (int i = 0; i < Model.Categories.Count; i++)
            {
                <input type="hidden" asp-for="@Model.Categories[i].Value" required/>
                <input asp-for=Categories[i].Selected id="checkbox_@i"/> @*@Model.Categories[i].Text*@
                <label for="checkbox_@i">@Model.Categories[i].Text</label>
                <br />
                <br />
            }
            <p id="error" style="color:#ff0000"></p>
            <input type="submit" value="Subscribe" class="btn btn-primary" />&nbsp &nbsp
            @*<input type="button" value="Unsubscribe" class="btn btn-primary" asp-action="UnSubscribeToNewsletter"/>  Needs logic to work *@
        </form>
        <form asp-controller="User" asp-action="UnSubscribeToNewsletter">
            <input type="submit" value="Unsubscribe" class="btn btn-primary" /> @* Needs logic to work *@
        </form>
    </div>

    <div class="col-md-6" id="newsletterDiv2">
        <h1>Your Newsletter</h1><br />

            @for (int i = 0; i < Model.Categories.Count; i++)
            {
                if (Model.Categories[i].Selected == true)
                {
                <p style="padding: 5px;"><span id="catsInNewsletter">@Model.Categories[i].Text</span></p>
                }
            }
    </div>
</div>

<script>

    window.addEventListener("load", resetForm)

    function resetForm() {

        var checkboxes = document.querySelectorAll('input[type="checkbox"]');

        checkboxes.forEach(function(checkbox) {
            checkbox.checked = false;
        });
    }

    // Implement code for restrictions of amount of categories selectable for basic, standard, premium newsletter

    document.getElementById("newsletterForm").addEventListener("submit",
        function (event) {

            var checkboxes = document.querySelectorAll('input[type="checkbox"]');

            var isChecked = false;

            for (var i = 0; i < checkboxes.length; i++) {
                if (checkboxes[i].checked) {
                    isChecked = true;
                    break;
                }
            }

            var errormess = document.getElementById("error");

            if (!isChecked) {
                event.preventDefault();
                errormess.textContent = "You must check at least one alternative.";

                document.getElementById("newsletterForm").addEventListener("change",
                    function (event) {
                        errormess.textContent = "";
                    });
            }
        });

</script>